Дорожная карта развития экосистемы Go2Asia
Go2Asia – это комплексная цифровая платформа для путешественников, экспатов, PRO-кураторов и бизнес-партнёров в Юго-Восточной Азии. Развитие экосистемы разбито на 5 фаз, где каждая фаза добавляет новую функциональность и инфраструктуру, придерживаясь единого подхода: фронтенды реализуются как PWA-модули (микрофронтенды) на Bolt, бэкенды – как микросервисы на Cursor, деплой осуществляется через Netlify и Cloudflare, а аутентификация централизована на провайдере SSO (например, Clerk). Ниже представлена поэтапная дорожная карта – цели каждой фазы, ключевые функции и технические реализации.


Фаза 0: Архитектурное основание (монорепозиторий и инфраструктура)
Цель фазы 0 – заложить прочный фундамент проекта перед разработкой пользовательских функций. На этом этапе создаётся единый монорепозиторий go2asia/ с продуманной структурой директорий и настраивается базовая инфраструктура:
•	Структура монорепозитория: Инициализирован репозиторий со стандартными “капсулами” для разных компонент: apps/ (фронтенд PWA-модули, например Atlas, Blog), services/ (микросервисы-бэкенды, напр. Auth, Content), packages/ (общие библиотеки, контракты, SDK) и infra/ (инфраструктурные конфигурации, скрипты). Такая структура упрощает совместную разработку и повторное использование кода.
•	CI/CD и окружение разработки: Настроены инструменты сборки и деплоя. Бэкенд-сервисы контейнеризуются с помощью Docker для унификации окружения; инициализируются миграции БД через ORM (Prisma или Drizzle). Внедрены GitHub Actions для автоматической сборки и тестирования на каждом pull request и деплоя при слиянии в main. Реализованы превью-окружения: каждая ветка разворачивается временно на Netlify (workflow “merge → preview → deploy”), что обеспечивает быстрые итерации и контроль качества.
•	Облачная инфраструктура: Зарегистрирован основной домен (например, go2asia.space) и подключён через Cloudflare для управления DNS. Cloudflare обеспечивает WAF и DDoS-защиту, а также выступает CDN для статики. Настроено облачное хранилище Cloudflare R2 для пользовательских медиа. Заложена основа для выполнения функций на Edge с помощью Cloudflare Workers – в будущих фазах планируется вынос тяжёлых задач (вебхуки, интенсивные API) на серверлесс-функции ближе к пользователю.
•	Единая аутентификация: Нужно интегрировать сервис SSO Clerk для единого входа. На этом этапе необходимо создать приложение в Clerk, настроить домены и callback-URL. Все фронтенд-модули будут использовать общую базу пользователей Clerk, позволяя авторизоваться один раз для доступа ко всем сервисам. Также нужно настроить базовую авторизацию: роли пользователей (например, обычный “Spacer”, VIP, PRO, партнёр, админ) должны определяться профилем Clerk; в будущем они будут применяться для ограничения доступа к контенту.
•	PWA-оболочка и микрофронтенды: Необходимо спроектировать фронтенд-архитектуру по принципу App Shell + Microfrontends и создать базовый каркас главного приложения (App Shell) – например, React + Vite или Next.js – развёрнутый на go2asia.space. App Shell должен обеспечивать общий UI (шапка, меню навигации) и содержать сервис-воркер для PWA. Стратегия подключения удалённых модулей предполагает, что используется либо Webpack Module Federation, либо ESM import maps для динамической подгрузки микрофронтендов по требованию. Благодаря этому каждая функциональная часть (Atlas, Blog и т.д.) сможет развиваться и деплоиться отдельно, а пользователи получат бесшовный UX единого приложения. Продумана навигация: определены URL-маршруты для основных разделов (например, /atlas для Atlas Asia, /blog для Blog Asia, /pulse для Pulse Asia и т.д.). Реализован подход mobile-first: все компоненты адаптируются под мобильные устройства, заложены основы офлайн-режима (кеширование критичного контента, отображение страницы “вы офлайн”). В инфраструктуру добавлены PWA-манифест (Web App Manifest) и заготовка сервис-воркера (на базе Workbox) с базовыми правилами кеширования по умолчанию.
•	Конфигурация деплоя: Настроены параметры сборки фронтендов для Netlify (например, netlify.toml в каждом модуле). Возможна схема, при которой основной App Shell деплоится как отдельное приложение, а микрофронтенды — как статика на CDN, доступная App Shell через URL для ленивой загрузки. Netlify развертывает билды, Cloudflare раздаёт их через глобальный CDN. Включены стандартные оптимизации (минификация, tree-shaking) и настроены заголовки безопасности (CSP, HSTS) через Cloudflare.
К концу фазы 0 разработчики получают готовый монорепозиторий с базовой инфраструктурой: все необходимые внешние сервисы (Clerk, Cloudflare, Netlify) интегрированы, CI/CD работает, архитектурные решения приняты. Такой фундамент позволяет оперативно приступить к запуску функциональных модулей на следующих этапах.


Фаза 1: Pilot Modules (первые контентные модули и базовые сервисы)
Цель фазы 1 – быстро выпустить основные контентные разделы платформы и запустить необходимые базовые бэкенд-сервисы. На этом этапе реализуются первые пилотные фронтенд-модули на Bolt v2 и параллельно – фундаментальные микросервисы на Cursor.
Фронтенд (Bolt, PWA-модули): разработаны и развёрнуты три ключевых контентных раздела:
•	Atlas Asia – WIKI-подобная энциклопедия локаций (страны, города, места). Реализована как PWA на Bolt: обеспечивает страницы описаний мест, подборок, с возможностью кэшировать последние просмотренные места для офлайн-доступа. Контент (описания, координаты, фото) на начальном этапе хранится во внешнем headless CMS или даже в JSON, но фронтенд получает данные через единый Content API (см. ниже).
•	Pulse Asia – афиша событий региона (лента событий). Фронтенд на Bolt отображает карточки мероприятий и поддерживает поиск/фильтрацию по тегам, дате, локации. Реализовано обновление ленты через API; для офлайна приложение кеширует некоторое количество последних событий или ближайших по времени, чтобы показывать контент даже при потере соединения.
•	Blog Asia – медиаплатформа (статьи, новости, истории). Фронтенд на Bolt с поддержкой SSR/SSG для SEO (важно для индексации статей поисковиками). Контент статей наполняется через внешний CMS (например, Contentful) либо в Markdown-репозитории; пользователям же статьи выдаются через тот же Content API или как статически сгенерированные страницы. Комментарии на этапе MVP реализованы с помощью стороннего виджета (например, Giscus/Disqus), чтобы не разрабатывать свою систему комментариев сразу.
Все три фронтенд-модуля интегрированы в общий PWA App Shell. При переходе пользователя на раздел (например, на /atlas) динамически подгружается соответствующий бандл Atlas Asia; при переходе на /blog – бандл Blog Asia и т.д. Загрузка модулей происходит лениво (lazy load) по требованию, с помощью механизма федеративных модулей или динамического импорта. В результате первоначальная загрузка приложения остаётся лёгкой и быстрой – загружается только оболочка, а контентные модули подтягиваются при первом посещении соответствующих страниц.
Бэкенд (Cursor, микросервисы): параллельно фронтенду команда на Cursor разворачивает ряд основных сервисов, необходимых с самого запуска платформы:
•	Auth Service – сервис аутентификации, интегрированный с Clerk. Хотя Clerk предоставляет готовое хранение пользователей и SSO, собственный Auth-сервис обрабатывает вебхуки Clerk (напр. событие создания нового пользователя) и хранит дополнительные сведения профиля в базе – например, реферальный код пользователя, роли или другие метаданные. Через него фронтенды могут получать JWT-токен Clerk и информацию о сессии. Если все модули работают под единым доменом, SSO прозрачное: после логина через Clerk на любом модуле, сессионная кука доступна всем приложениям на go2asia.space. Auth Service служит единой точкой для действий вроде подтверждения email, обновления профиля (проксируя запросы к Clerk) и закладывает возможность расширения (например, поддержка альтернативных методов аутентификации, если в будущем потребуется миграция с Clerk).
•	Content API Service – сервис контента, объединяющий данные для Atlas, Pulse, Blog. Это своего рода headless CMS внутри экосистемы: единая база данных (напр. PostgreSQL) с моделями для статей, мест, событий, тегов и пр. На фазе 1 реализован минимальный набор схем (Post, Place, Event, Tag и др.) и предоставлен REST/GraphQL API для фронтендов. Например, фронт Atlas делает запрос GET /api/content/places?country=VN чтобы получить список мест по стране; Blog – GET /api/content/posts?tag=travel для статей с определённым тегом. Content API обеспечивает консистентность данных между модулями и общую точку доступа. (На MVP часть контента может временно храниться во внешнем CMS и периодически импортироваться, но важен факт единой точки чтения для фронтов уже на этом этапе.) В дальнейшем, к фазам 2–3, возможна эволюция этого сервиса в несколько специализированных (например, отдельный сервис для ленты новостей, сервис для геоданных Atlas и т.д.), с плавным переключением через feature-flag по мере готовности новых сервисов.
•	Referral Service – сервис реферальной программы (backend для будущего модуля Connect Asia). На фазе 1 заложена базовая логика рефералов: генерация уникальных реферальных кодов для пользователей, хранение связей “кто кого пригласил” и начисление базовых бонусов за регистрацию приглашённых. Хотя полноценный фронтенд-кабинет Connect появится только в фазе 2, запуск реферального сервиса с самого начала позволяет стимулировать рост аудитории с первого дня: уже при запуске Blog/Pulse пользователи могут получать свои реферальные ссылки и приглашать друзей. Сервис интегрируется с Auth/Clerk: при регистрации нового пользователя по реферальной ссылке Clerk через webhook уведомляет Referral Service, и пригласившему начисляются бонусные поинты (с помощью Token Service). Логика пока простая (одноуровневая рефералка, фиксированные бонусы без сложных правил).
•	Token Service – сервис внутренней валюты лояльности G2A Points. Ведёт учёт баланса поинтов (не криптовалюта, а внутренняя off-chain валюта) на счетах пользователей. На фазе 1 этот сервис начисляет поинты за базовые события: успешная регистрация по реферальному коду, первые активности пользователя (например, первый пост, первый лайк). Реализация проста: таблица балансов и транзакций поинтов в базе; никаких блокчейн-функций на этом этапе, поинты “живут” только в системе. Token Service предоставляет API для получения баланса (GET /api/token/balance?userId=…) и начисления/списания поинтов (вызывается другими сервисами, напр. Referral Service при срабатывании рефералки). В перспективе (фаза 3) этот сервис станет частью более сложной экономики с привязкой к реальному токену G2A, но на первом этапе всё максимально упрощено.
Обмен данными фронтенда с бэкендом организован через открытые API. Контентные модули Atlas, Pulse, Blog в основном делают анонимные запросы к Content API для получения данных. Небольшое число запросов, требующих авторизации (например, отправка комментария), сопровождается Clerk JWT токеном в заголовке; бэкенды валидируют этот JWT через Auth Service или с помощью библиотек Clerk на каждом сервисе. Взаимодействие между микросервисами тоже строго через API или очереди: например, когда Referral Service начисляет поинт, он вызывает REST-метод Token Service для увеличения баланса – прямого доступа к чужой базе нет. Такой принцип (обмен данными только через сервисы, без общей базы) повышает слабую связанность модулей и устойчивость системы.
Деплой и интеграция: по окончании разработки функционала фазы 1 выполняется автоматический деплой фронтендов и сервисов. GitHub Actions собирает фронтенды Atlas, Pulse, Blog (npm build) и загружает статику на Netlify (например, каждый модуль деплоится либо в свою поддиректорию, либо вместе с App Shell). Одновременно Actions разворачивает бэкенд-сервисы – их Docker-образы отправляются в registry и запускаются либо на VM (Docker Compose), либо в Kubernetes-кластере, либо на serverless-платформе (возможные варианты обсуждаются, например Yandex Cloud, Fly.io и т.д.). Cloudflare CDN начинает раздачу фронтенд-статики по всему миру, а Cloudflare WAF защищает API (вводятся ограничения по частоте запросов, гео-блоки и пр. с помощью правил).
Аутентификация пользователей: к концу фазы 1 платформа поддерживает полноценную регистрацию и логин через Clerk во всех модулях. Гостевой режим допускается для просмотра публичного контента (локации, статьи, события без авторизации), однако активные действия (комментирование, лайки, сохранение избранного) требуют входа в систему. После логина Clerk устанавливает сессионную cookie на домене .go2asia.space, видимую всем микрофронтендам, поэтому App Shell и модули распознают авторизованного пользователя. В UI, например, появляется иконка профиля, скрываются призывы войти. При нажатии “Войти” в любом модуле вызывается виджет Clerk (popup или встроенная форма); после успешного OAuth или email-пароля Clerk возвращает JWT токен, который сохраняется и используется фронтом (через Clerk SDK) и передаётся бэкендам (для валидации запросов). Пока бизнес-логика авторизации минимальна (Clerk берёт на себя всё), роль Auth Service сведена к проксированию и хранению доп. данных. Разграничение прав на этапе MVP простое: например, можно реализовать клиентский проверочный флаг “VIP” для доступа к некоторым постам (без строгого серверного контроля). Итог фазы 1 – экосистема запущена в базовом виде: пользователи могут заходить, читать статьи, просматривать карты и события, регистрироваться и получать реферальные бонусы. Социальные функции и сложная экономика пока впереди, но ядро платформы уже функционирует.


Фаза 2: Core Modules (социальные и партнерские модули, расширение бэкенда)
Цель фазы 2 – добавить в экосистему ключевые интерактивные сервисы и социальные механики, а также расширить возможности бэкенда для поддержки роста. В этой фазе запускаются новые фронтенд-модули с богатыми возможностями для пользователей и внедряются дополнительные бэкенд-сервисы. Также подключаются общие инфраструктурные компоненты для хранения данных и поиска.
Новые фронтенд-модули:
•	Space Asia – полноценная социальная сеть внутри Go2Asia. Фронтенд Space реализует ленту новостей, профиль пользователя, возможно группы и чаты. Модуль интегрирован в App Shell (в навигации появляется вкладка «Профиль / Space»). Пользователи могут создавать контент: посты, комментарии, личные заметки. Упор сделан на мобильный UX: бесконечная прокрутка фида, мгновенная отдача уже закешированных постов при плохом интернете, офлайн-доступ к ранее загруженной ленте, возможность писать черновики офлайн. Для Space используются общие компоненты дизайн-системы (аватары, карточки поста и пр.), а также подключается клиентский SDK для push-уведомлений (OneSignal или Firebase через сервис-воркер App Shell) – чтобы пользователи получали уведомления о новых лайках, комментариях и сообщениях. Примечание: основные данные Space (посты, связи, уведомления) хранятся на сервере, об этом далее.
•	Connect Asia – реферально-партнёрский кабинет. Фронтенд Connect служит местом, где пользователи видят статистику приглашённых друзей, прогресс по реферальной программе, а PRO-кураторы и бизнес-партнёры – свои показатели. Реализован отдельный микрофронтенд (роут /connect, также доступ из бокового меню). В пользовательском режиме Connect показывает “кошелёк” накопленных поинтов и токенов, дерево рефералов (1-го и 2-го уровня), достижения (статусы VIP, награды). UI включает графики, таблицы транзакций, фильтры по датам – данные для них приходят из соответствующих сервисов (Referral, Token и др.). Офлайн-функциональность для Connect не критична (требуются актуальные данные с сервера), однако можно кешировать последний просмотренный баланс, чтобы офлайн показать хоть какую-то информацию.
•	Russian Friendly – модуль работы с бизнес-партнёрами и привилегиями для туристов. Состоит из публичной витрины партнёров и кабинета для самих партнёров. На фазе 2 реализуется публичная витрина: каталог мест-партнёров (отели, рестораны, сервисы) с фильтрами и поиском. Это Bolt-приложение, интегрированное в общую оболочку. Пользователям он показывает список партнёров с особыми условиями/скидками для русскоговорящих туристов (Russian Friendly). На этом этапе взаимодействие одностороннее (чтение каталога), поэтому офлайн-режим может позволять просматривать ранее загруженный список партнеров. Для PRO/Partner-режима добавляются разделы: привлечение новых бизнес-партнёров, отчёты по активности партнёров, начисленные комиссии. Кабинет партнёра (для бизнесов) пока не реализуется и планируется на следующие фазы.
•	Quest Asia – модуль геймификации (квесты и задания для пользователей). Quest предлагает миссии для вовлечения аудитории: например, посетить определённое место и отметиться, пройти маршрут, создать контент – за выполнение пользователь получает награды (поинты, NFT-бейджи). Фронтенд Quest реализован как PWA с игровыми элементами: список доступных квестов, страница детали квеста, интерфейс отслеживания прогресса (progress bar, отметка чек-поинтов). Реализация на Bolt учитывает офлайн-доступ: активный квест сохраняется локально, чтобы пользователь мог продолжать без сети; прогресс синхронизируется при появлении интернета (через Background Sync).
•	Guru Asia – интерактивный “гид рядом со мной”. Guru – модуль, показывающий на карте и списком все интересные объекты поблизости пользователя: места из Atlas, события из Pulse, активных PRO-пользователей из Space, места партнеров из каталога RF, активные квесты из Quest. Это основной экран для туриста, возможно даже главный маршрут / приложения. Фронтенд Guru – карта (Leaflet или Mapbox GL) + список объектов, фокус на геолокации. Особенность Guru: должна работать даже при плохом интернете, поэтому внедрено агрессивное кэширование данных о ближайших объектах (последние загруженные точки сохраняются в IndexedDB). Если сети нет, Guru отображает офлайн-экран с сообщением и последние сохранённые данные (например, список 5 мест неподалёку). UI Guru тесно переплетён с другими модулями: карточки объектов ведут на соответствующие страницы (место → Atlas, событие → Pulse, место партнёра → RF, PRO-пользователь → Space, квест → Quest), поэтому дизайн карточек унифицирован, навигация между модулями бесшовная.

Все новые модули подключаются к App Shell аналогично предыдущим – через маршрутизацию и ленивую загрузку их бандлов. Кнопки/вкладки для Space, Connect, RF, Quest, Guru добавлены в общую навигацию (например, Space – в нижнее меню профиля, Guru – как отдельная кнопка или даже главная страница приложения).
Расширение бэкенда: для поддержки новых функций фаза 2 вводит дополнительные микросервисы и инфраструктурные компоненты:
•	Space Service: бэкенд для социальной сети Space Asia. Хранит и обрабатывает данные постов, комментариев, связей “друзей”, уведомлений и т.п. Обеспечивает API для ленты (например, GET /api/space/feed?userId=…), для публикации поста, для управления подписками/друзьями, модерацию контента. Возможно, реализован на Cursor с использованием WebSocket/Realtime для обновления фидов в режиме реального времени (опционально на следующей фазе). Также, может быть интегрирован сервис уведомлений (Notifications Service) или встроена логика отправки push через существующие инструменты (OneSignal) по событиям (лайк, комментарий, упоминание).
•	Quest Service: бэкенд для квестов (Quest Asia). Хранит список всех игровых заданий, правила их выполнения, и учёт прогресса каждого пользователя. При старте квеста фронтенд вызывает, например, POST /api/quest/start?questId=X, и сервис регистрирует прохождение. По ходу, пользователь отмечает шаги (POST /api/quest/update), которые сервис сохраняет (с поддержкой офлайн-режима и идемпотентных повторных запросов при восстановлении сети). По завершении квеста Quest Service начисляет награды: вызывает Token Service для добавления поинтов, фиксирует выдачу NFT-бейджа (пока просто запись, т.к. блокчейн-интеграция будет позже). Возможна отправка уведомлений о выполнении квеста – либо напрямую через интеграцию с push-сервисом, либо через общий Notifications-сервис (если таковой будет выделен).
•	Guru Service: агрегатор геоданных для модуля Guru. Собирает данные из разных сервисов (Atlas, Pulse, Space, RF) чтобы выдать пользователю единый список “что вокруг” по геокоординатам. Выступает как Backend-for-Frontend: фронтенд делает один запрос GET /api/guru/nearby?lat=..&lng=.., а Guru Service внутри запрашивает другие сервисы (места, события, партнеры, пользователей) и агрегирует результат. Для производительности используются гео-индексы и кэширование результатов в памяти; возможно, периодическое обновление кэша по популярным локациям, чтобы ответы отдавались мгновенно. Guru Service – пример микросервиса-“клея” чисто на Cursor без фронтенда Bolt, который связывает данные нескольких модулей.
•	Расширение Referral/Connect: реферальный сервис, запущенный в фазе 1, продолжает работать, но теперь задействован фронтенд Connect. В фазе 2 он может обогащаться функциями для PRO-спейсеров и партнёров: например, учёт подключенных бизнес-партнёров, расчёт комиссий PRO, API для заявок новых партнёров. Вводится дифференциация ролей: PRO-кураторы видят доп. данные и могут отправлять заявки, партнеры – управлять своим профилем (эти функции могут требовать отдельного Partner Service в будущем, либо расширения Referral Service). Также рассматривается Notifications Service для рассылки email/Telegram уведомлений партнёрам о заявках (элемент интеграции, может быть реализован через внешние сервисы в фазе 3).
•	Storage & Search: подключаются общие инфраструктурные сервисы для хранения файлов и поиска. На фазе 2 вводится централизованное хранилище медиа на Cloudflare R2 (если не было ранее) для загрузки пользовательских фото, аватаров, изображений контента – все модули используют его через общий API или прямой доступ. Для полнотекстового поиска и индексации данных внедряется поисковый движок (например, Meilisearch или ElasticSearch). Возможно, Meilisearch поднимается как сервис в infra/ и индексирует контент Blog, Pulse, места Atlas для быстрого поиска и автодополнения. Это позволяет улучшить поиск по платформе (например, глобальный поиск в топ-баре App Shell ищет сразу по статьям, локациям, пользователям). Данные из Content API могут дублироваться в поисковый индекс для эффективности.
•	Admin Panel / CMS: создаётся единая административная панель для управления контентом во всех модулях экосистемы Go2Asia. Админпанель реализуется как отдельный фронтенд-модуль (PWA на Bolt) с доступом по ролям (Editor, Moderator, Admin) через Clerk SSO. Функциональность включает: управление контентом модулей Фазы 1 (Atlas Asia: страны, города, места; Pulse Asia: события; Blog Asia: статьи) и модулей Фазы 2 (Space Asia: модерация постов и комментариев; Quest Asia: создание и редактирование квестов; Russian Friendly: управление партнёрами; Connect Asia: просмотр статистики рефералов). Ключевые возможности: CRUD-операции для всех типов контента, загрузка и управление медиафайлами в R2 через удобный интерфейс (drag & drop, предпросмотр, обрезка изображений), модерация пользовательского контента (Space), управление галереями (Atlas), публикация/снятие с публикации контента, управление тегами и категориями, просмотр аналитики и статистики. Админпанель взаимодействует с существующими микросервисами через их API (Content API, Space Service, Quest Service и др.), не требуя прямого доступа к базам данных. Это полностью заменяет необходимость во внешних CMS (например, Contentful), так как весь контент управляется через единый интерфейс, работающий напрямую с внутренними сервисами и Neon PostgreSQL. На этапе MVP (Фаза 1) контент наполняется через SQL-скрипты в Neon Console, но с появлением админпанели в Фазе 2 эта необходимость отпадает – редакторы и модераторы получают удобный веб-интерфейс для управления всем контентом платформы.
•	Event Bus / PubSub: запускается механизм асинхронных событий для связи между сервисами. Реализован через либо Valhalla Streams (условно, Valkey Streams) либо Cloudflare Queues – то есть распределённую очередь или шину событий. С её помощью микросервисы обмениваются уведомлениями: например, Quest Service после завершения квеста шлёт событие quest.completed в шину, которое ловит Referral Service (начислить реферальный бонус если привёл игрока) и Notification Service (отправить push о достижении). Такой Event Bus повышает масштабируемость и отвязывает модули: они реагируют на события, не вызывая напрямую друг друга.
После реализации фазы 2 экосистема переходит от MVP к более социально ориентированному продукту. Пользователи получают инструменты общения (Space), вовлечения (Quest, Guru), партнёрского взаимодействия (Connect, RF), что значительно повышает ценность платформы. Технически появилось больше сервисов, но за счёт модульной архитектуры их удалось интегрировать без ломки существующих функций – через добавление новых API и событий. Хранилище и поиск теперь централизованы, что готовит платформу к росту объёма данных.


Фаза 3: Интеграция и экономика (крипто-шлюз, токеномика, аналитика)
Цель фазы 3 – превратить экосистему в самодостаточную экономику и интегрировать все сервисы в единое пользовательское пространство. Добавляются сервисы для работы с блокчейном (криптокошелёк, токен G2A), вводятся механики токеномики и DAO, появляется единый пользовательский кабинет, а также существенно усиливаются аналитические возможности системы.
Основные нововведения фазы 3:
•	Blockchain Wallet Gateway: реализуется компонент-шлюз для интеграции с блокчейном TON (The Open Network) – выбранной платформой токена G2A. Wallet Gateway обеспечивает двустороннюю связь между off-chain системой (внутренние Points, локальные NFT) и on-chain активами (токены G2A, NFT в блокчейне). Проще говоря, это мост:
– Off-chain → On-chain: например, пользователь накопил достаточно очков (Points) и хочет выпустить свой NFT-бейдж в блокчейне. Фронтенд (например, в кабинете Connect) делает запрос к Wallet Gateway, тот через TON SDK выполняет чеканку NFT или выпуск токенов G2A на блокчейн, и возвращает подтверждение. Одновременно обновляется статус внутренней награды (помечается как выведенная on-chain). 
– On-chain → Off-chain: обратный процесс – например, пользователь приобретает внешние G2A-токены и хочет использовать их в системе. Gateway принимает транзакцию с кошелька пользователя (через TON Connect), проверяет её и сообщает внутренним сервисам, чтобы начислить эквивалентные Points или разблокировать внутриигровые преимущества. Или партнёр платит G2A-токенами за сервисы платформы – Gateway уведомляет нужный сервис (например, RF) и инициирует предоставление услуги.
Технически Wallet Gateway может быть отдельным сервисом Cursor (Node.js + TON SDK) или Cloudflare Worker (если логика несложная и нужны быстрые реакции на вебхуки). Особое внимание – безопасности: приватные ключи токенов/NFT должны храниться надёжно (HSM или сторонний custodial-сервис). На фронтенде в Connect появляется интеграция с TON Wallet (привязка кошелька, отображение баланса on-chain).
•	Эволюция Token Service и токеномика: после интеграции блокчейна вводится собственно токен G2A – утилитарный крипто-токен экосистемы. Token Service на фазе 3 расширяется: помимо Points, начинает учитывать баланс G2A-токенов у пользователей. Реализованы ключевые механики токеномики:
– Конвертация Points ↔️ G2A: Пользователи могут обменивать накопленные поинты на токены G2A по установленному курсу. Процесс: пользователь инициирует обмен, Token Service блокирует соответствующее количество Points и вызывает Wallet Gateway, который начисляет пользователю G2A на блокчейн. Обратный обмен (G2A → Points) также возможен через обратную транзакцию: например, партнёр тратит G2A на рекламу внутри платформы – токены списываются через Gateway, а Token Service добавляет партнеру Points или предоставляет услуги.
– DAO и голосования: внедряются элементы децентрализованного управления сообществом. Держатели токенов G2A (особенно PRO-кураторы) получают право голосовать за изменения в платформе: выбирать новые функции, решать вопросы развития сообщества. Технически реализуется смарт-контракт DAO на TON; фронтенд (например, раздел Governance) показывает текущие голосования, и токен-холдеры голосуют посредством своих токенов. Можно предусмотреть Governance Service или использовать существующие DAO-платформы, интегрируя их через Wallet Gateway.
– Монетизация контента: токеномика позволяет ввести платные функции. Например, платный контент (paywall) в Blog Asia: отдельные статьи доступны только за токены G2A. При покупке статьи пользователем часть токенов может идти автору (если он PRO), часть – в казну платформы. Реализация: фронтенд проверяет наличие токенов или подписки (в JWT или через запрос), при попытке доступа – инициирует оплату через Wallet Gateway. Отмечается, что в случае платного контента необходим надёжный бэкенд-контроль (как обсуждалось в Bolt vs Cursor). На фазе 3 упор делается на собственную криптоэкономику, поэтому предпочтительно завязать paywall на G2A-токены (покупка токенов вне системы и трата внутри) вместо фиатных платежей.
– NFT и достижения: локальные NFT-бейджи, заработанные пользователями, теперь можно вывести в блокчейн – делая их реальными NFT-активами. И наоборот, возможно создание эксклюзивных NFT для продажи или наград. Например, ограниченные коллекционные бейджи для топ-участников или партнеров. Это создаёт вокруг платформы рынок ценностей и стимулирует активность (пользователи понимают, что их достижения могут иметь ценность вне платформы).
В совокупности фаза 3 превращает систему лояльности в двухконтурную экономику: Points остаются невостребуемой вне платформы внутренней валютой (геймификация, рейтинг), а G2A-токены становятся связующим звеном с внешним миром ценностей. Внутри платформы токены используются в большинстве транзакций: партнёры платят комиссию в G2A, PRO получают вознаграждения в G2A, рекламные услуги покупаются за G2A и т.д. Разработчики обеспечивают плавную интеграцию всех этих функций модульно – через отдельные сервисы (Gateway, расширенный Token Service) без нарушения работы существующих модулей.
•	Единый пользовательский дашборд: особое внимание уделяется объединению разбросанных функций в единый UX для пользователя. В профиле Space появляется “кабинет”, агрегирующий всю активность и достижения пользователя. Фактически, данные из разных модулей собираются вместе:
– Баланс Points и G2A токенов (из Token/Connect сервисов).
– Коллекция полученных NFT-бейджей (из Quest/Token сервисов).
– Статистика рефералов и партнёров (из Connect/RF).
– Уровень пользователя (обычный, VIP, PRO) и связанные преимущества.
Происходит слияние функциональности Connect Asia и профиля Space: пользователь видит и социальные метрики, и финансовые в одном месте. Реализация может быть двоякой: либо реально объединить фронтенды (напр. встроить виджеты Connect в интерфейс Space через модульную федерацию), либо оставить их раздельными, но при открытии профиля Space делать несколько API-запросов к разным сервисам и отображать агрегированные данные на одной странице. Возможно создание специального Profile BFF (Backend-for-Frontend) – эндпоинта, который сам собирает все данные профиля на сервере и возвращает одним ответом, чтобы сократить количество запросов с клиента. В любом случае, в фазе 3 пользователь получает единое окно со всей своей информацией: социальные уведомления, реферальные успехи, прогресс квестов, баланс кошелька – всё на одном экране. Это повышает вовлечённость, устраняя необходимость переключаться между разделами.
•	Расширенная аналитика и мониторинг: с ростом функциональности важно понимать, как платформой пользуются и насколько она стабильна. В фазе 3 внедряется масштабируемая система аналитики и наблюдаемости:
•	Сбор данных: настраивается сбор логов и событий со всех компонентов. Cloudflare может предоставлять сырые логи запросов по домену и статистику CDN, эти данные перенаправляются во внутреннее хранилище. Все микросервисы рассылают телеметрию – события действий пользователей (регистрации, посты, клики, рефералы, покупки и т.д.) в центральное хранилище (через очередь или напрямую).
•	Хранилище аналитики: выбирается колонночная БД, способная обрабатывать большие объёмы – например, ClickHouse (очень быстр для агрегаций) либо использовать готовое решение Supabase Analytics. ClickHouse может быть развернут как сервис (в infra/ Docker); данные – логи, события – периодически сбрасываются в него. Также может использоваться хранилище на основе Data Lakes.
•	Метрики и дашборды: запускается система визуализации – например, Grafana в связке с БД аналитики или готовые панели Supabase Insights. Отслеживаются ключевые метрики: DAU/MAU (активность пользователей), количество новых рефералов, число выполненных квестов, выданных поинтов и токенов, популярность модулей (просмотры Blog vs Pulse), конверсия приглашённых в VIP и прочее. Эти данные помогают принимать продуктовые решения и находить узкие места.
•	Мониторинг здоровья системы: внедряется мониторинг инфраструктуры и оповещения (alerting). Сервисы публикуют технические метрики (CPU, память, время ответа) в Prometheus, настроены алёрты – например, падение Auth Service или увеличение latency Guru Service >1с вызывает оповещение команды. Можно использовать self-hosted стек (Prometheus + Grafana) или облачные решения (Datadog, Sentry для ошибок). Цель – оперативно узнавать о проблемах и деградациях, чтобы масштабировать систему или чинить баги. Cloudflare Analytics также предоставляет ценную инфу по производительности на Edge (hit/miss кэша, география трафика), что используется для оптимизаций.
•	Интеграции внешних сервисов: на этом этапе могут подключаться дополнительные внешние API для расширения возможностей:
o	Geo API: для улучшения геофункций Guru/Atlas – интеграция Google Maps API или OpenStreetMap Overpass для геокодинга, POI-информации.
o	Маркетинговые инструменты: e-mail рассылки (SendGrid/Mailchimp) для новостей, Telegram-боты для уведомлений о событиях, вебхуки со сторонними сервисами. Например, возможно, Clerk уже отправляет базовые письма (верификация email), но можно добавить рассылку дайджеста лучших постов через отдельный cron-сервис.
o	AI-функции: появляются первые элементы AI. Например, “AI-гид” в Guru – чатбот, отвечающий на вопросы о местах, на базе данных Atlas или с помощью GPT-модели. Или автоматическая модерация контента: отправка текстов на проверку AI для фильтрации запрещённого контента. Эти функции интегрируются по мере готовности как вспомогательные модули – например, вызывать OpenAI API через отдельный сервис при необходимости.
После завершения фазы 3 экосистема Go2Asia выходит на новый уровень: кроме контента и соцсети, у платформы появляется своя экономика. Пользователи материально мотивированы – их активность может конвертироваться в ценные токены, которыми можно оперировать вне платформы. Партнёры получают прозрачные механизмы расчётов и продвижения через токен G2A, а платформа – инструменты удержания аудитории (токены и NFT стимулируют участие и лояльность). Технически система стала сложнее, но благодаря модульности (добавление нового сервиса не ломает старые) и отделению экономических функций (Gateway, блокчейн) основная платформа остается стабильной. Все новые возможности интегрированы мягко – через доп. сервисы и API, сохранив преемственность и совместимость.


Фаза 4: Оптимизация и устойчивость (масштабирование, Edge-вычисления)
Цель фазы 4 – обеспечить долгосрочную масштабируемость, производительность и отказоустойчивость экосистемы. К этому этапу Go2Asia обросла множеством функций и активной аудиторией, поэтому приоритет – оптимизация инфраструктуры: перенос части нагрузки на Edge, масштабирование баз данных, ускорение отдачи медиа и усиление безопасности на уровне платформы.
Основные направления оптимизации на фазе 4:
•	Edge-функции для нагруженных задач: анализ метрик выявляет самые частые и тяжёлые запросы. Эти части выносятся на распределённые вычисления на Edge (Cloudflare Workers, Yandex Functions), чтобы снизить нагрузку на центральный сервер и уменьшить задержки для пользователей по всему миру. Примеры:
– Локальная обработка простых запросов: некоторые API, не требующие обращения к основной базе, реализуются прямо на Edge. Напр., обработка статических конфигов или простых роутингов – Cloudflare Worker может сразу вернуть кэшированный ответ из ближайшего датацентра. Или проверка промо-кода: хранится в KV-хранилище Cloudflare, валидируется на Edge без запроса к основному сервису.
– Агрегация на Edge: возьмём Guru Service, собирающий данные из нескольких сервисов – его логику можно перенести в Worker, чтобы кэшировать результаты на Edge. Тогда при запросе nearby-объектов воркер держит в памяти копию недавних данных (обновляет раз в N минут) и возвращает результат мгновенно.
– Вебхуки и нотификации: внешние вебхуки (например, от Clerk или платежного шлюза) может принимать Edge-функция – она сразу подтверждает получение (быстро отвечает отправителю), ставит задачу в очередь, а основная система обрабатывает чуть позже. Аналогично, рассылку push-уведомлений множеству получателей можно инициировать на Edge, распараллелив отправку через push-сервис, не нагружая основной backend.
– Geo-распределение сервисов: при росте глобальной аудитории можно запустить критичные сервисы (Auth, Content) в нескольких регионах. Cloudflare Workers упрощает это – код деплоится по всем датацентрам, и запросы обслуживаются ближайшим узлом. Yandex Functions можно использовать для резидентности в РФ, если нужно, или для доп. отказоустойчивости, распределяя нагрузку между провайдерами.
Для вынесения логики на Edge зачастую требуется рефакторинг кода: выделение чистых функций, минимально зависящих от основной БД, и/или организация репликации данных (например, периодически выгружать справочники в KV-хранилище Cloudflare). CI/CD конвейер дополняется шагами деплоя скриптов Workers при изменениях соответствующих модулей. В итоге значительная часть трафика (30-40%) может обслуживаться без обращения к центральной инфраструктуре, повышая пропускную способность и снижая время ответа.
•	Масштабирование базы данных: ранее, вероятно, использовалась одиночная PostgreSQL (возможно в управляемом облаке). К фазе 4 объём данных сильно вырос, поэтому рассматривается переход на Neon – облачную serverless Postgres, которая отделяет хранение от вычислений и автоматически масштабируется по нагрузке. Шаги: миграция основных баз (контент, пользователи, партнеры, соцсеть) на Neon или аналогичный сервис (Amazon Aurora, Azure Hyperscale), который поддерживает вертикальное и горизонтальное авто-масштабирование, создание read-replicas и шардирование при необходимости. Neon позволяет создавать временные Branch-снапшоты – полезно для аналитики (снять срез продакшн-данных и выполнять тяжёлые запросы отдельно). Также обеспечивается высокая доступность БД (распределение по зонам, автоматические бэкапы). Кроме Postgres, оптимизируются и другие хранилища:
– Логи и аналитика остаются на ClickHouse (который тоже можно кластеризовать).
– Вводится, если не сделано раньше, Redis для кэшей, сессий или очередей.
– Полнотекстовый поиск остаётся на Meilisearch/Elastic, которые можно масштабировать кластером.
Особое внимание Token Service: с появлением on-chain токенов и множества транзакций, возможно выделение его хранилища отдельно (но часть нагрузки как раз ушла в блокчейн). После миграции на Neon и оптимизации хранилищ бэкенд сможет выдержать порядок больший трафик без деградации производительности.
•	Оптимизация медиа-контента: для ускорения загрузки и снижения нагрузки от изображений внедряются дополнительные решения:
– Image CDN/Resizing: подключается сервис Cloudflare Image Resizing для динамической оптимизации изображений. Теперь запросы картинок (аватар, фото места) проходят через специальный URL Cloudflare, который автоматически ресайзит и конвертит изображение (например, в WebP под нужное разрешение). Фронтенд обновляется, чтобы использовать эти оптимизированные ссылки. Это снижает трафик и ускоряет загрузку на мобильных устройствах.
– Агрессивное кеширование медиа: на CDN настраиваются длительные сроки кеша для статических ресурсов. Загружаемые пользователями фото, статьи и прочий контент теперь отдаются с версионными URL или хэшами, что позволяет Cloudflare кешировать их месяцами. При публикации нового контента, система генерирует уникальный URL (например, добавляя хэш), поэтому кеш-инвалидация происходит автоматически. Также внедряется ленивоя загрузка изображений (lazy-load) на фронте, чтобы не загружать их раньше времени. Для ручной инвалидации предусмотрен механизм: при явном обновлении контента (например, редактировании статьи) GitHub Actions или админ-панель вызывают API Cloudflare Purge для очистки конкретных URL, чтобы новые версии сразу начали раздаваться.
•	Безопасность и гейтинг на Edge: усиливается безопасность за счёт вынесения ряда проверок на уровень CDN/Edge. Реализуются правила предварительного отсева неавторизованных или запрещённых запросов ещё до попадания на бэкенд:
o	Проверка Auth JWT на Edge: Cloudflare Workers могут проверять наличие и валидность JWT-токена Clerk в куках/заголовках. Например, настроить Worker на маршруте /api/space/* – если нет валидной сессии, мгновенно возвращать 401 или редиректить на логин, не нагружая сервис Space.
o	Гейтинг по ролям: некоторые чувствительные ресурсы доступны только определённым ролям (VIP, PRO, admin и т.д.). Вместо проверки в каждом сервисе, можно вынести логику в Edge: воркер декодирует JWT (публичный ключ Clerk доступен), проверяет claim роли и решает – пропустить запрос дальше или отклонить. Например, запрос к /api/rf/admin/list сразу блокируется на Edge, если у пользователя нет роли admin. Аналогично можно защищать платный контент: Edge-воркер проверит в JWT наличие подписки или токена и выдаст либо контент, либо заглушку. Эти меры добавляют слой защиты и уменьшают нагрузку на сервера.
o	Rate Limiting и Bot Management: активно настраиваются встроенные средства Cloudflare по ограничению запросов и борьбе с ботами. Ограничивается частота вызовов к API (например, N запросов в минуту с IP) для предотвращения спама, вводятся CAPTCHA или JavaScript Challenge для подозрительного трафика. Включаются Firewall Rules для блокировки известных вредоносных адресов, стран и т.д. Все это делает систему более устойчивой к злоумышленникам.
•	Рефакторинг и улучшения кода: одновременно проводится аудит и оптимизация самого приложения:
o	Устранение технического долга: решения, принятые на скорую руку в MVP-фазах, переписываются на более масштабируемые. Например, если Blog до сих пор читал статьи напрямую из Contentful, к фазе 4 он полностью переводится на внутренний Content API (feature-flag переключён). Жёстко захардкоженные параметры выносятся в конфиг, временные заглушки заменяются постоянными решениями.
o	Оптимизация запросов: добавляются недостающие индексы в БД, переписываются особо тяжёлые JOIN-запросы, внедряются кэши для часто запрашиваемых данных (например, топ-10 постов дня хранится в Redis).
o	Устойчивость микросервисов: внедряются паттерны Circuit Breaker и ретраев. Если один сервис (или внешний API) не отвечает, запросы не должны бесконечно ждать – реализуется быстрый отказ с возвращением кэшированных данных или сообщений об ошибке, чтобы сбой одного сервиса не приводил к цепному падению всей системы. Очереди настроены с повторными попытками с экспоненциальной задержкой для надежной обработки фоновых задач.
o	Контрактная типизация: пакет @go2asia/contracts с общими TypeScript-типами для запросов/ответов обновляется и строго используется во всех сервисах и фронтендах. Это гарантирует совместимость интерфейсов: при изменении API типы обновляются централизованно, исключая ошибки несоответствия между фронтом и бекендом.
После всех этих оптимизаций экосистема Go2Asia становится по-настоящему эластичной и устойчивой. PWA-фронтенд работает быстро даже при слабом соединении или на устаревших устройствах; значительная часть запросов обслуживается кэшем или Edge-функциями, обеспечивая мгновенный отклик. Бэкенд распределён и зарезервирован: сбой отдельного сервиса не парализует систему (благодаря очередям и резервным копиям), данные защищены от потери (кластеризация БД, бэкапы), рост нагрузки автоматически масштабируется (Neon, серверлесс-воркеры). Иными словами, платформа готова к увеличению аудитории в разы без кардинальной переработки архитектуры.


Ключевые принципы архитектуры
В ходе всех фаз развития Go2Asia неизменно соблюдаются несколько основных принципов архитектуры, заложенных с самого начала:
•	Микрофронтенды на Bolt: каждый модуль фронтенда создан как самостоятельное PWA-приложение (Capsule) с собственным циклом разработки и деплоя. Это обеспечивает независимость команд и возможность обновлять части системы без влияния на другие (например, можно развёртывать обновление Blog Asia отдельно от Atlas Asia).
•	Микросервисы на Cursor: серверная логика разбита на отдельные сервисы в каталоге services/* (Auth, Content, Referral, Token и т.д.). Каждый микросервис отвечает за свою область данных и функциональности, общение между ними только через открытые API, что улучшает масштабируемость и изоляцию сбоев.
•	CI/CD и автоматизация: весь процесс разработки автоматизирован через GitHub Actions – от сборки до деплоя. Код размещён в монорепозитории, где при каждом изменении запускаются тесты, сборка, деплой фронтендов на Netlify и обновление сервисов на сервере/в облаке. Внедрена схема Preview Deployments для быстрого тестирования фич перед выпуском.
•	Единая аутентификация: все модули доверяют одному провайдеру SSO (Clerk) и общей базе пользователей. Пользователь проходит логин один раз и получает доступ ко всем разделам, а токены/сессии унифицированы (JWT куки на домене).
•	Коммуникация через API, а не через общие базы: никакой модуль не лезет прямо в базу другого – взаимодействие только через REST/GraphQL API, Webhook или очередь событий. Например, фронтенд Blog никогда напрямую не читает базу Content, а вызывает Content API. Микросервисы тоже не делят базы – Auth Service не пишет в базу Token Service, а вызывает его метод начисления поинтов. Этот принцип снижает связность, повышает безопасность и упрощает масштабирование.
•	Feature Flags и адаптивность: при эволюции системы используется механизм feature-flag’ов для плавного переключения функций и сервисов. Например, переход от внешнего CMS к своему Content API или запуск новых сервисов происходит постепенно: сначала сервис вводится в фоне, затем через флаг переключается источник данных. Это позволяет обновлять архитектуру без простоев и с возможностью отката.
•	Контрактное программирование: фронтенд и бэкенд “договорились” о форматах данных и типах через общий репозиторий @go2asia/contracts. Единые типы (например, интерфейс объекта Place или структура API-запроса) используются повсеместно, что предотвращает несовместимость. Синхронизация достигается генерацией этих контрактов и импорта в проекты Bolt и Cursor.
Придерживаясь этих принципов на всех этапах, команда Go2Asia смогла развить систему от MVP до полноценной экосистемы без фундаментальных переделок архитектуры. Такая продуманная стратегия развития позволила пошагово нарастить возможности платформы, сохраняя стабильность и обеспечивая готовность к будущему росту.
________________________________________




## Дополнение - Blockchain Gateway

**Назначение:**  
Инфраструктурный микросервис, отвечающий за взаимодействие экосистемы Go2Asia с блокчейном TON.  
Он обеспечивает безопасный обмен между внутренним контуром (Points и off-chain G2A) и внешним on-chain миром (токен G2A, NFT-награды, DAO-активности).  
Работает в связке с Token Service, но выполняет только функции мостового и кастодиального уровня.

---

### Основные функции

1. **Mint / Burn NFT**
   - Создание (mint) и сжигание (burn) NFT-трофеев, бейджей и ваучеров по запросу платформы.  
   - Управление метаданными NFT: тип, уровень, владелец, срок действия, история.  
   - Поддержка off-chain → on-chain синхронизации через webhook-триггеры Token Service.

2. **G2A Bridge**
   - Выполнение операций вывода/ввода токенов G2A между внутренним балансом (off-chain учёт) и внешним кошельком пользователя (on-chain TON).  
   - Процедура вывода:
     - пользователь создаёт заявку →  
     - Token Service блокирует сумму →  
     - Blockchain Gateway выполняет on-chain перевод и создаёт запись burn внутри off-chain реестра.  
   - Процедура ввода:
     - пользователь отправляет депозит на master-кошелёк →  
     - Gateway фиксирует транзакцию и создаёт запись mint внутри off-chain реестра.

3. **Safe Custody**
   - Хранение ключей мастер-кошельков (G2A, NFT, DAO) в защищённом хранилище.  
   - Генерация временных транзакций через подпись серверным ключом без раскрытия приватных данных.  
   - Возможность интеграции с HSM или Tonkeeper SDK для пользовательских кошельков.

4. **Event Relay**
   - Передача событий в другие микросервисы (Token Service, Connect Asia, Quest Asia, RF Merchant API).  
   - Поддержка очередей (например, через Redis Streams или Cloud Tasks) и механизма идемпотентности.

5. **Audit & Transparency**
   - Ведение журнала всех on-chain операций и соответствующих off-chain транзакций.  
   - Возможность публичного просмотра транзакций через TON explorer.  
   - Подготовка агрегированных отчётов для DAO/администрации.

---

### Архитектурное положение

- Развёртывается как отдельный микросервис (`services/blockchain-gateway`).  
- Использует API TON (через TonWeb или ton-core).  
- Обменивается событиями с:
  - **Token Service** — логика начислений и учёта балансов;  
  - **NFT Service** — хранение метаданных бейджей и трофеев;  
  - **Connect Asia** — отражение вознаграждений и статусов в профилях.  
- Работает асинхронно через очередь событий и REST-вебхуки.

---

### Безопасность

- Все операции требуют JWT-аутентификации от внутренних сервисов.  
- Лимиты на вывод, анти-фрод-триггеры и охлаждение транзакций (cooldown).  
- Off-chain данные — первичны; on-chain — подтверждающий слой.  
- Пользовательские ключи не хранятся на платформе.

---

### Этап внедрения

- **Фаза 0–1:** подготовка интерфейса взаимодействия (mock API, контракты, webhooks).  
- **Фаза 2:** реализация мостов G2A и NFT-minting в тестовой сети TON.  
- **Фаза 3:** включение DAO-транзакций, публичных отчётов и расширенной кастодиальности.



## Дополнение - Anti-Abuse & Risk Controls

**Назначение:**  
Система защиты экосистемы Go2Asia от злоупотреблений, мультиаккаунтов, фарминга вознаграждений и подозрительных транзакций.  
Anti-Abuse-механизмы действуют на уровне Points, NFT, G2A и реферальных программ, предотвращая искажение экономики и рейтингов.

---

### Основные принципы

1. **Лимиты начислений**
   - Суточный и недельный лимит Points/токенов для одного пользователя (настраиваемый по уровню: Spacer, VIP, PRO).  
   - Отдельные лимиты по типам действий (лайки, посты, квесты, ваучеры, рефералы).  
   - Превышение лимита переводит начисления в статус «pending» до ручной проверки.

2. **Поведенческий анализ**
   - Анализ временных и географических паттернов (аномально частые действия, множественные регистрации с одного устройства/IP).  
   - Проверка «цепочек взаимных лайков» и «каруселей рефералов».  
   - Отслеживание внезапного роста активности (более X действий в минуту/час) с автоматическим триггером «cooldown».

3. **Подтверждение партнёрских операций**
   - Все транзакции с премиум-ваучерами и покупками у партнёров подтверждаются бизнес-партнёром через RF-Merchant API.  
   - Только подтверждённые операции активируют начисление Points/G2A.  
   - При расхождении статусов (оплачено / не подтверждено) — ручная модерация.

4. **Модерация аномалий**
   - Все аномальные действия попадают в очередь **Moderation Queue**.  
   - Ручная проверка оператором (роль Moderator/Admin).  
   - Возможные решения: «approve», «reject», «reduce reward», «ban».  
   - Логирование в модуль **Audit & Transparency** (в Blockchain Gateway / Token Service).

5. **Санкции и репутация**
   - Для нарушителей: понижение статуса (VIP → Spacer), блокировка начислений, временные баны.  
   - Репутация пользователя (score) снижается при каждом нарушении.  
   - Для PRO-спейсеров — система предупреждений и рейтингов доверия.

---

### Архитектурное положение

- Микросервис `services/anti-abuse` или встроенный модуль в **Token Service**.  
- Использует:
  - **Redis / Cloud Tasks** — для отслеживания частоты действий;
  - **Connect Asia** — для валидации реферальных связей;
  - **RF Merchant API** — для подтверждения платежей;
  - **Moderation Dashboard** — веб-интерфейс для ручной проверки.

---

### Этап внедрения

- **Фаза 0–1:** базовые лимиты начислений, регистрация подозрительных действий в логах.  
- **Фаза 2:** анти-фрод правила, cooldown-таймеры, API подтверждения партнёров.  
- **Фаза 3:** поведенческий анализ, рейтинги репутации, дашборд модерации и уведомления.
